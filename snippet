    # OCR from inline images and attachments
    ocr_data = []
    image_sources = parsed.get("inline_images", []) + parsed.get("image_attachments", [])

    for img_path in image_sources:
        if isinstance(img_path, str) and img_path.lower().endswith((".png", ".jpg", ".jpeg")):
            try:
                ocr_rows = run_easyocr_and_parse_table(img_path)
                ocr_data.extend(ocr_rows)
            except Exception as e:
                print(f"[WARNING] OCR failed for {img_path}: {e}")
        else:
            print(f"[SKIPPED] Non-image or invalid path: {img_path}")
