import extract_msg
from typing import Dict, List


def parse_msg_file_categorized(file_path: str) -> Dict:
    """
    Parses a .msg file and categorizes content as:
    - subject
    - plain text body
    - HTML body
    - image attachments (bytes)
    """
    msg = extract_msg.Message(file_path)
    msg.encoding = 'utf-8'

    content = {
        "subject": msg.subject,
        "text_body": msg.body or "",
        "html_body": msg.htmlBody or "",
        "inline_images": [],         # Inline images if detected (optional future)
        "image_attachments": []      # Images for OCR
    }

    for attachment in msg.attachments:
        filename = attachment.longFilename.lower()
        if filename.endswith((".png", ".jpg", ".jpeg")):
            content["image_attachments"].append(attachment.data)

    return content
