import extract_msg
import os

def load_msg_email(file_path):
    msg = extract_msg.Message(file_path)
    msg_subject = msg.subject
    msg_sender = msg.sender
    msg_date = msg.date
    msg_body = msg.body

    return {
        'subject': msg_subject,
        'from': msg_sender,
        'date': msg_date,
        'body': msg_body
    }

def split_mail_chain(body):
    import re
    pattern = r'\nOn .+ wrote:\n'  # basic split on "On [date], X wrote:"
    return re.split(pattern, body)
