from parsers.msg_parser import parse_msg_file
from nlp.sentence_splitter import clean_and_split_sentences
from nlp.spacy_extractor import extract_with_spacy

if __name__ == "__main__":
    file_path = "data/sample_emails/sample1.msg"
    parsed = parse_msg_file(file_path)
    raw_text = parsed['html'] if parsed['html'] else parsed['body']

    # Attributes we want to extract
    user_fields = ["RoRWA", "VA", "CVA", "FVA", "RCVA"]

    spacy_based = extract_with_spacy(raw_text, user_fields)

    print("\n--- SPA CY-BASED EXTRACTION ---\n")
    for attr, vals in spacy_based.items():
        print(f"{attr}: {vals}")
