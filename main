from parsers.msg_parser import parse_msg_file
from nlp.sentence_splitter import clean_and_split_sentences

if __name__ == "__main__":
    file_path = "data/sample_emails/sample1.msg"
    parsed = parse_msg_file(file_path)

    # Prefer HTML if available, else plain
    email_text = parsed['html'] if parsed['html'] else parsed['body']
    
    print("\n==== CLEANED SENTENCES ====\n")
    sentences = clean_and_split_sentences(email_text)
    for i, s in enumerate(sentences):
        print(f"{i+1:02d}. {s}")
