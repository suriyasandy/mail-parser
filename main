from parsers.msg_parser import parse_msg_file
from nlp.sentence_splitter import clean_and_split_sentences
from nlp.attribute_extractor import extract_attributes

if __name__ == "__main__":
    file_path = "data/sample_emails/sample1.msg"
    parsed = parse_msg_file(file_path)
    raw_text = parsed['html'] if parsed['html'] else parsed['body']

    sentences = clean_and_split_sentences(raw_text)

    # ðŸ‘‡ User-defined fields (can be made configurable later)
    fields = ["Trade ID", "Price", "Quantity", "Settlement Date"]

    extracted = extract_attributes(sentences, fields)

    print("\n--- EXTRACTED ATTRIBUTES ---\n")
    for attr, values in extracted.items():
        print(f"{attr}: {values}")
